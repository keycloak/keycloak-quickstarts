{"version":3,"file":"FileUploadForm-96efeae2.js","sources":["../../src/components/json-file-upload/FileUploadForm.tsx"],"sourcesContent":["import {\n  ChangeEvent,\n  DragEvent as ReactDragEvent,\n  MouseEvent as ReactMouseEvent,\n  useState,\n} from \"react\";\nimport { FormGroup, Modal, ModalVariant, Button } from \"@patternfly/react-core\";\nimport { DropEvent } from \"react-dropzone\";\nimport { useTranslation } from \"react-i18next\";\nimport { CodeEditor, Language } from \"@patternfly/react-code-editor\";\n\nimport { FileUpload, FileUploadProps } from \"./patternfly/FileUpload\";\n\ntype FileUploadType = {\n  value: string;\n  filename: string;\n  isLoading: boolean;\n  modal: boolean;\n};\n\nexport type FileUploadEvent =\n  | ReactDragEvent<HTMLElement> // User dragged/dropped a file\n  | ChangeEvent<HTMLTextAreaElement> // User typed in the TextArea\n  | ReactMouseEvent<HTMLButtonElement, MouseEvent>; // User clicked Clear button\n\nexport type FileUploadFormProps = Omit<FileUploadProps, \"onChange\"> & {\n  id: string;\n  extension: string;\n  onChange: (value: string) => void;\n  helpText?: string;\n  unWrap?: boolean;\n  language?: Language;\n};\n\nexport const FileUploadForm = ({\n  id,\n  onChange,\n  helpText = \"common-help:helpFileUpload\",\n  unWrap = false,\n  language,\n  extension,\n  ...rest\n}: FileUploadFormProps) => {\n  const { t } = useTranslation();\n  const defaultUpload: FileUploadType = {\n    value: \"\",\n    filename: \"\",\n    isLoading: false,\n    modal: false,\n  };\n  const [fileUpload, setFileUpload] = useState<FileUploadType>(defaultUpload);\n  const removeDialog = () => setFileUpload({ ...fileUpload, modal: false });\n\n  const handleFileInputChange = (_event: DropEvent, file: File) => {\n    setFileUpload({ ...fileUpload, filename: file.name });\n  };\n\n  const handleTextOrDataChange = (value: string) => {\n    setFileUpload({ ...fileUpload, value });\n    onChange(value);\n  };\n\n  const handleClear = () => {\n    setFileUpload({ ...fileUpload, modal: true });\n  };\n\n  return (\n    <>\n      {fileUpload.modal && (\n        <Modal\n          variant={ModalVariant.small}\n          title={t(\"clearFile\")}\n          isOpen\n          onClose={removeDialog}\n          actions={[\n            <Button\n              key=\"confirm\"\n              variant=\"primary\"\n              data-testid=\"clear-button\"\n              onClick={() => {\n                setFileUpload(defaultUpload);\n                onChange(\"\");\n              }}\n            >\n              {t(\"clear\")}\n            </Button>,\n            <Button\n              data-testid=\"cancel\"\n              key=\"cancel\"\n              variant=\"link\"\n              onClick={removeDialog}\n            >\n              {t(\"cancel\")}\n            </Button>,\n          ]}\n        >\n          {t(\"clearFileExplain\")}\n        </Modal>\n      )}\n      {unWrap && (\n        <FileUpload\n          id={id}\n          {...rest}\n          type=\"text\"\n          value={fileUpload.value}\n          filename={fileUpload.filename}\n          onFileInputChange={handleFileInputChange}\n          onDataChange={handleTextOrDataChange}\n          onTextChange={handleTextOrDataChange}\n          onClearClick={handleClear}\n          onReadStarted={() =>\n            setFileUpload({ ...fileUpload, isLoading: true })\n          }\n          onReadFinished={() =>\n            setFileUpload({ ...fileUpload, isLoading: false })\n          }\n          isLoading={fileUpload.isLoading}\n          dropzoneProps={{\n            accept: { \"application/text\": [extension] },\n          }}\n        />\n      )}\n      {!unWrap && (\n        <FormGroup\n          label={t(\"resourceFile\")}\n          fieldId={id}\n          helperText={t(helpText)}\n        >\n          <FileUpload\n            data-testid={id}\n            id={id}\n            {...rest}\n            type=\"text\"\n            value={fileUpload.value}\n            filename={fileUpload.filename}\n            onFileInputChange={handleFileInputChange}\n            onDataChange={handleTextOrDataChange}\n            onTextChange={handleTextOrDataChange}\n            onClearClick={handleClear}\n            onReadStarted={() =>\n              setFileUpload({ ...fileUpload, isLoading: true })\n            }\n            onReadFinished={() =>\n              setFileUpload({ ...fileUpload, isLoading: false })\n            }\n            isLoading={fileUpload.isLoading}\n            hideDefaultPreview\n          >\n            {!rest.hideDefaultPreview && (\n              <CodeEditor\n                isLineNumbersVisible\n                code={fileUpload.value}\n                language={language}\n                height=\"128px\"\n                onChange={handleTextOrDataChange}\n                isReadOnly={!rest.allowEditingUploadedText}\n              />\n            )}\n          </FileUpload>\n        </FormGroup>\n      )}\n    </>\n  );\n};\n"],"names":["FileUploadForm","id","onChange","helpText","unWrap","language","extension","rest","t","useTranslation","defaultUpload","fileUpload","setFileUpload","useState","removeDialog","handleFileInputChange","_event","file","handleTextOrDataChange","value","handleClear","jsxs","Fragment","jsx","Modal","ModalVariant","Button","FileUpload","FormGroup","CodeEditor"],"mappings":"6MAkCO,MAAMA,EAAiB,CAAC,CAC7B,GAAAC,EACA,SAAAC,EACA,SAAAC,EAAW,6BACX,OAAAC,EAAS,GACT,SAAAC,EACA,UAAAC,EACA,GAAGC,CACL,IAA2B,CACnB,KAAA,CAAE,EAAAC,GAAMC,IACRC,EAAgC,CACpC,MAAO,GACP,SAAU,GACV,UAAW,GACX,MAAO,EAAA,EAEH,CAACC,EAAYC,CAAa,EAAIC,WAAyBH,CAAa,EACpEI,EAAe,IAAMF,EAAc,CAAE,GAAGD,EAAY,MAAO,GAAO,EAElEI,EAAwB,CAACC,EAAmBC,IAAe,CAC/DL,EAAc,CAAE,GAAGD,EAAY,SAAUM,EAAK,KAAM,CAAA,EAGhDC,EAA0BC,GAAkB,CAChDP,EAAc,CAAE,GAAGD,EAAY,MAAAQ,CAAO,CAAA,EACtCjB,EAASiB,CAAK,CAAA,EAGVC,EAAc,IAAM,CACxBR,EAAc,CAAE,GAAGD,EAAY,MAAO,EAAM,CAAA,CAAA,EAG9C,OAEKU,EAAA,KAAAC,WAAA,CAAA,SAAA,CAAAX,EAAW,OACVY,EAAA,IAACC,EAAA,CACC,QAASC,EAAa,MACtB,MAAOjB,EAAE,WAAW,EACpB,OAAM,GACN,QAASM,EACT,QAAS,CACPS,EAAA,IAACG,EAAA,CAEC,QAAQ,UACR,cAAY,eACZ,QAAS,IAAM,CACbd,EAAcF,CAAa,EAC3BR,EAAS,EAAE,CACb,EAEC,WAAE,OAAO,CAAA,EARN,SASN,EACAqB,EAAA,IAACG,EAAA,CACC,cAAY,SAEZ,QAAQ,OACR,QAASZ,EAER,WAAE,QAAQ,CAAA,EAJP,QAKN,CACF,EAEC,WAAE,kBAAkB,CAAA,CACvB,EAEDV,GACCmB,EAAA,IAACI,EAAA,CACC,GAAA1B,EACC,GAAGM,EACJ,KAAK,OACL,MAAOI,EAAW,MAClB,SAAUA,EAAW,SACrB,kBAAmBI,EACnB,aAAcG,EACd,aAAcA,EACd,aAAcE,EACd,cAAe,IACbR,EAAc,CAAE,GAAGD,EAAY,UAAW,GAAM,EAElD,eAAgB,IACdC,EAAc,CAAE,GAAGD,EAAY,UAAW,GAAO,EAEnD,UAAWA,EAAW,UACtB,cAAe,CACb,OAAQ,CAAE,mBAAoB,CAACL,CAAS,CAAE,CAC5C,CAAA,CACF,EAED,CAACF,GACAmB,EAAA,IAACK,EAAA,CACC,MAAOpB,EAAE,cAAc,EACvB,QAASP,EACT,WAAYO,EAAEL,CAAQ,EAEtB,SAAAoB,EAAA,IAACI,EAAA,CACC,cAAa1B,EACb,GAAAA,EACC,GAAGM,EACJ,KAAK,OACL,MAAOI,EAAW,MAClB,SAAUA,EAAW,SACrB,kBAAmBI,EACnB,aAAcG,EACd,aAAcA,EACd,aAAcE,EACd,cAAe,IACbR,EAAc,CAAE,GAAGD,EAAY,UAAW,GAAM,EAElD,eAAgB,IACdC,EAAc,CAAE,GAAGD,EAAY,UAAW,GAAO,EAEnD,UAAWA,EAAW,UACtB,mBAAkB,GAEjB,SAAA,CAACJ,EAAK,oBACLgB,EAAA,IAACM,EAAA,CACC,qBAAoB,GACpB,KAAMlB,EAAW,MACjB,SAAAN,EACA,OAAO,QACP,SAAUa,EACV,WAAY,CAACX,EAAK,wBAAA,CACpB,CAAA,CAEJ,CAAA,CACF,CAEJ,CAAA,CAAA,CAEJ"}